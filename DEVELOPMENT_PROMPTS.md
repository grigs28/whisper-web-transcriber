# 🎯 Whisper Web音频转录系统开发提示词

## 📋 项目需求概述
请开发一个基于Flask和SocketIO的现代化Web音频转录管理系统，具备以下核心特性：

### 🎯 核心功能要求
1. **Web界面**: 使用Bootstrap 5创建现代化、响应式的用户界面
2. **文件上传**: 支持拖拽和点击上传，批量文件处理
3. **音频转录**: 集成OpenAI Whisper模型进行音频转文本转换
4. **队列管理**: 实现任务队列系统，支持并发处理和状态跟踪
5. **实时通信**: 使用WebSocket推送实时状态更新和日志信息
6. **GPU支持**: 自动检测GPU可用性，支持多GPU选择和CPU回退

## 🏗️ 技术架构要求

### 后端技术栈
- **Flask**: 主Web框架，处理HTTP请求和路由
- **Flask-SocketIO**: WebSocket实时通信，支持异步事件推送
- **OpenAI Whisper**: 音频转录引擎，支持多种模型大小
- **PyTorch**: 深度学习框架，GPU/CPU自适应
- **Threading**: 多线程处理，后台任务队列
- **Logging**: 完整的日志系统，支持轮转和级别控制

### 前端技术栈
- **Bootstrap 5**: 响应式UI框架
- **Socket.IO客户端**: WebSocket连接和事件处理
- **Font Awesome**: 图标库
- **原生JavaScript**: 交互逻辑，无需额外框架

## 📁 文件结构要求
```
whisper/
├── app.py                    # 主应用程序
├── requirements.txt          # 依赖包列表
├── README.md                # 项目文档
├── .gitignore               # Git忽略文件
├── templates/
│   └── index.html           # 主页面模板
├── static/
│   ├── css/
│   │   └── style.css        # 自定义样式
│   ├── js/
│   │   └── app.js           # 前端逻辑
│   └── webfonts/            # 字体文件
├── uploads/                 # 上传文件存储
├── outputs/                 # 转录结果存储
└── logs/                    # 日志文件
```

## 🔧 核心功能实现要求

### 1. 队列管理系统
- 实现线程安全的任务队列
- 支持任务状态跟踪（queued, processing, completed, failed）
- 提供任务计时器，显示实际运行时间
- 支持页面刷新后状态恢复
- 实现批量任务控制（开始、停止、删除）

### 2. WebSocket实时通信
- 实现以下事件类型：
  - `task_update`: 任务状态更新
  - `log_message`: 日志消息推送
  - `system_message`: 系统状态通知
- 支持客户端连接管理
- 实现断线重连机制

### 3. 文件管理系统
- 支持的音频格式：MP3, MP4, WAV, OPUS, FLAC, M4A, WEBM, OGG
- 最大文件大小：500MB
- 实现文件预览、下载、删除功能
- 自动清理过期文件（可配置天数）
- 安全的文件名处理

### 4. GPU管理
- 自动检测可用GPU设备
- 支持多GPU选择和负载均衡
- CPU模式自动回退
- 内存管理和模型释放

### 5. API接口设计
```
POST /add_to_queue          # 添加转录任务
POST /api/stop_transcription # 停止任务
GET /api/status             # 获取系统状态
GET /api/uploaded_files     # 文件列表
GET /download/<filename>    # 文件下载
GET /delete/<filepath>      # 文件删除
```

## 🎨 UI/UX设计要求

### 界面布局
1. **顶部导航**: 系统标题和状态指示器
2. **上传区域**: 拖拽上传框，支持多文件选择
3. **配置面板**: 模型选择、GPU选择、语言设置
4. **队列显示**: 实时任务列表，状态和进度显示
5. **文件管理**: 上传文件和输出文件的管理界面
6. **日志面板**: 实时日志显示和系统消息

### 交互特性
- 拖拽上传动画效果
- 实时进度条和状态更新
- 响应式设计，支持移动端
- 友好的错误提示和用户反馈
- 批量操作确认对话框

## ⚙️ 配置和部署要求

### 环境配置
- Python 3.8+
- 支持Windows、Linux、macOS
- 自动创建必要目录
- 环境变量支持

### 性能优化
- 模型缓存和内存管理
- 异步任务处理
- 文件流式上传
- 日志轮转和大小控制

### 安全考虑
- 文件类型验证
- 路径遍历防护
- 文件大小限制
- 敏感信息保护

## 📝 代码质量要求

1. **注释**: 所有函数和关键逻辑都要有详细的中文注释
2. **错误处理**: 完善的异常捕获和用户友好的错误提示
3. **日志记录**: 详细的操作日志和错误追踪
4. **代码结构**: 模块化设计，职责分离
5. **性能**: 内存使用优化，避免内存泄漏

## 🧪 测试要求

- 支持多种音频格式的转录测试
- GPU和CPU模式切换测试
- 并发任务处理测试
- WebSocket连接稳定性测试
- 文件上传和下载功能测试

## 📚 文档要求

- 详细的README.md文档
- API接口文档
- 安装和部署指南
- 故障排除指南
- 开发者指南

请根据以上要求，创建一个功能完整、用户友好、技术先进的Whisper音频转录Web应用系统。